---
- hosts: webservers
  vars_files:
   - config.yml
  tasks:
   - name: include nodejs role
     include_role:
       name: nodejs

   - name: install nginx
     become: yes
     yum: name={{item}} state=present update_cache=yes
     with_items:
     - nginx

   - name: change port
     become: yes
     copy:
       src: ./default.conf
       dest: /etc/nginx/conf.d/default.conf

   - name: Run nginx
     become: yes
     service:
      name: nginx
      state: restarted

- hosts: anotherWebserver
  vars_files:
    - config.yml
  tasks:
    - name: include nodejs role
      include_role:
        name: nodejs
